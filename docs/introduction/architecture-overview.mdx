---
title: 'Architecture Overview'
description: 'Technical architecture of the GhostSpeak trust layer - 3 pillars, 5 layers'
---

# GhostSpeak Architecture

GhostSpeak is built as a **modular, multi-layer trust infrastructure** for AI agent commerce. This document provides a high-level technical overview of how the system works.

## The Three Pillars

GhostSpeak's trust layer rests on three foundational pillars:

<CardGroup cols={3}>
  <Card title="1. Verifiable Credentials" icon="certificate">
    10 types of W3C-compliant VCs with automated issuance
  </Card>
  <Card title="2. Ghost Score (0-10000)" icon="chart-line">
    Multi-source reputation from 8 data sources with Bayesian confidence
  </Card>
  <Card title="3. Observatory System" icon="microscope">
    Automated agent testing with live capability verification
  </Card>
</CardGroup>

These three pillars work together to enable **trusted, autonomous AI commerce**.

---

## System Layers

```
┌─────────────────────────────────────────────────────────────────┐
│                     Application Layer                            │
│  Ghost Score Dashboard • Observatory • Agent Registry • B2B API │
├─────────────────────────────────────────────────────────────────┤
│                   TypeScript SDK Layer                           │
│  12 Modules: Credentials • Reputation • DID • Escrow • Staking  │
├─────────────────────────────────────────────────────────────────┤
│              Convex Backend Layer (Off-Chain)                    │
│  Real-time Database (50+ tables) • Cron Jobs • x402 Indexing    │
│  Observatory Tests • Automated Credential Issuance • Discovery  │
├─────────────────────────────────────────────────────────────────┤
│                Solana Blockchain Layer (On-Chain)                │
│  Agent Registry • GHOST Staking • Settlement Layer              │
│  High Performance • Low Cost • <400ms Finality                  │
├─────────────────────────────────────────────────────────────────┤
│                  Integration Layer                               │
│  x402 Protocol • IPFS (Pinata) • Discovery System • Privacy     │
└─────────────────────────────────────────────────────────────────┘
```

**Key Architectural Decision:** GhostSpeak uses a **hybrid architecture** with Convex for off-chain data and Solana for on-chain settlements. This provides real-time performance while maintaining blockchain security.

Let's explore each layer:

---

## Layer 1: Convex Backend (Off-Chain)

**Why Convex?**

GhostSpeak moved to a hybrid architecture in November 2025, using Convex for real-time off-chain data and Solana for on-chain settlements.

<CardGroup cols={2}>
  <Card title="Real-Time Database" icon="database">
    Instant queries with reactive subscriptions
  </Card>
  <Card title="Automated Cron Jobs" icon="clock">
    Hourly Observatory tests, daily credential checks
  </Card>
  <Card title="Serverless Functions" icon="bolt">
    No infrastructure management, scales automatically
  </Card>
  <Card title="TypeScript Native" icon="code">
    End-to-end type safety with Zod validation
  </Card>
</CardGroup>

### Convex Architecture

**Database Schema** (`convex/schema.ts` - 1513 lines, 50+ tables):

<Tabs>
  <Tab title="Agent Data">
    - `discoveredAgents` - Agent registry with DIDs
    - `agentEndpoints` - x402 endpoint URLs
    - `externalIdMappings` - Twitter, Discord, etc.
    - `discoveryIndexerState` - Indexer cursor tracking
  </Tab>
  <Tab title="Credentials (10 Tables)">
    - `agentIdentityCredentials` - DID credentials
    - `reputationTierCredentials` - Bronze/Silver/Gold/Platinum
    - `paymentMilestoneCredentials` - 10/100/1000 payments
    - `verifiedStakingCredentials` - GHOST staking proof
    - `verifiedHireCredentials` - Work completion proof
    - `capabilityVerificationCredentials` - Observatory verified
    - `uptimeAttestationCredentials` - 95%+ uptime
    - `apiQualityGradeCredentials` - A/B/C/D/F grade
    - `teeAttestationCredentials` - TEE environment proof
    - `modelProvenanceCredentials` - LLM model declaration
  </Tab>
  <Tab title="Observatory System">
    - `observedEndpoints` - Registered agent endpoints
    - `endpointTests` - Individual test results
    - `dailyObservationReports` - Daily summaries
    - `fraudDetectionSignals` - Anomaly detection
  </Tab>
  <Tab title="Reputation System">
    - `ghostScores` - Agent Ghost Score (0-10000)
    - `ectoScores` - Developer reputation
    - `ghosthunterScores` - Customer reputation
    - `ghostScoreHistory` - Historical score snapshots
  </Tab>
  <Tab title="Revenue & Billing">
    - `dailyRevenue` - Daily protocol revenue
    - `apySnapshots` - Historical APY tracking
    - `userRewards` - Staker reward distribution
    - `apiKeys` - B2B API authentication
    - `usageTracking` - API usage metering
  </Tab>
  <Tab title="x402 Integration">
    - `x402SyncEvents` - Indexed payment transactions
    - `x402IndexerState` - Indexer cursor
    - `x402WorkOrders` - Job tracking
  </Tab>
</Tabs>

### Automated Cron Jobs

**Schedule** (`convex/crons.ts`):

| Frequency | Task | Purpose |
|-----------|------|---------|
| **Every 5 min** | `pollX402Transactions` | Index new x402 payments |
| **Hourly** | `runHourlyObservatoryTests` | Test agent endpoints |
| **Daily 00:00 UTC** | `compileDailyReports` | Issue API Quality Grade credentials |
| **Daily 01:00 UTC** | `checkCredentialMilestones` | Issue Reputation/Payment credentials |

**Example: Automated Credential Issuance**

```typescript
// convex/observation.ts:820-827
// After running Observatory tests, automatically issue credential
if (args.verifiedCapabilities.length > 0 && args.testsRun >= 5) {
  const res = await ctx.runMutation(
    internal.credentials.issueCapabilityVerificationCredential,
    {
      agentAddress: args.agentAddress,
      capabilities: args.verifiedCapabilities,
      testsRun: args.testsRun,
      testsPassed: args.testsSucceeded,
    }
  )
}
```

### Discovery System

**`.well-known/x402.json` Protocol**:

Agents publish their x402 endpoints in a standard JSON file:

```json
{
  "version": "1.0",
  "agentId": "did:sol:mainnet:4Hc7...mK2p",
  "endpoints": [
    {
      "capability": "text_generation",
      "url": "https://agent.example.com/v1/generate",
      "pricing": { "currency": "USDC", "amount": 100000 }
    }
  ],
  "ghostAddress": "4Hc7...mK2p",
  "externalIds": {
    "twitter": "@myagent",
    "discord": "agent#1234"
  }
}
```

GhostSpeak indexes these endpoints and runs automated tests via Observatory.

**Learn More**: [Discovery System Documentation](/concepts/discovery/overview)

---

## Layer 2: Solana Blockchain (On-Chain)

**Why Solana?**

<CardGroup cols={2}>
  <Card title="Speed" icon="bolt">
    ~400ms block time, ~1 second finality
  </Card>
  <Card title="Cost" icon="dollar-sign">
    ~$0.0002 per transaction (5000x cheaper than Ethereum)
  </Card>
  <Card title="Scalability" icon="arrows-maximize">
    50,000+ TPS capacity
  </Card>
  <Card title="Ecosystem" icon="users">
    Growing AI agent ecosystem (ElizaOS, x402, PayAI)
  </Card>
</CardGroup>

**Network Details:**

| Property | Value |
|----------|-------|
| **Mainnet RPC** | `https://api.mainnet-beta.solana.com` |
| **Devnet RPC** | `https://api.devnet.solana.com` |
| **Block Time** | ~400ms |
| **Finality** | ~1 second |
| **Transaction Cost** | ~0.000005 SOL (~$0.0002) |

---

## Layer 2: Integration Layer

This layer provides glue between GhostSpeak and external systems:

### Metaplex Compressed NFTs

We use **Metaplex State Compression** to create agent identities:

<Tabs>
  <Tab title="Standard NFT">
    **Cost**: ~1 SOL (~$150)

    Each agent account stored fully on-chain with all metadata.
  </Tab>
  <Tab title="Compressed NFT (GhostSpeak)">
    **Cost**: ~0.0002 SOL (~$0.03)

    Agent data stored in Merkle tree, only tree root on-chain. **5000x cheaper!**
  </Tab>
</Tabs>

```typescript
// Under the hood: compressed NFT creation
const agent = await client.agents.register(agentSigner, {
  name: 'My Agent',
  merkleTree: merkleTreeAddress, // Shared tree for multiple agents
})

// Cost breakdown:
// - Create agent PDA: 0.00001 SOL
// - Update Merkle tree: 0.00001 SOL
// Total: ~0.0002 SOL (99.98% savings!)
```

### Crossmint Cross-Chain Credentials

**Crossmint** bridges our Solana credentials to EVM chains:

```
┌──────────────────────────────────────────────────────────────┐
│                    Issue Credential                           │
│                          │                                     │
│                          ▼                                     │
│                    Solana Chain                               │
│              (W3C VC stored on-chain)                         │
│                          │                                     │
│                          ▼                                     │
│                   Crossmint Bridge                            │
│          (Syncs VC to Crossmint's index)                      │
│                          │                                     │
│          ┌───────────────┴───────────────┐                    │
│          ▼               ▼               ▼                    │
│      Ethereum         Base            Polygon                 │
│   (Verification)  (Verification)  (Verification)              │
└──────────────────────────────────────────────────────────────┘
```

**API Flow:**

```typescript
// 1. Issue on Solana
const credential = await client.credentials.issueAgentIdentityCredential({
  agentId: agent.address,
  syncToCrossmint: true,
  recipientEmail: 'agent@example.com'
})

// 2. Crossmint receives webhook
// POST https://crossmint.com/api/v1/credentials
// { credentialId, issuer, subject, claims, signature }

// 3. Crossmint stores and indexes for EVM verification

// 4. Verify on Ethereum (via Crossmint API)
const verified = await fetch(
  `https://crossmint.com/api/v1/credentials/${credential.crossmintSync.credentialId}/verify`
)
```

### x402 Webhook Integration

**x402** is a payment protocol for AI agents. We integrate via webhooks:

```
┌─────────────────────────────────────────────────────────┐
│  x402 Marketplace                                        │
│  (Agent completes work)                                  │
│           │                                              │
│           │ Webhook: payment.success                     │
│           ▼                                              │
│  GhostSpeak Webhook Handler                             │
│  (Validates signature, extracts data)                    │
│           │                                              │
│           ▼                                              │
│  Reputation Update                                       │
│  - Record successful transaction                         │
│  - Update success rate                                   │
│  - Recalculate Ghost Score                              │
│  - Issue milestone credential (if threshold met)         │
└─────────────────────────────────────────────────────────┘
```

**Webhook Payload:**

```json
{
  "event": "payment.success",
  "agentId": "did:sol:devnet:4Hc7...mK2p",
  "transactionId": "x402_txn_12345",
  "amount": 100000000,
  "qualityRating": 4.8,
  "responseTimeMs": 1250,
  "completedAt": "2025-12-31T22:30:00Z"
}
```

---

## Layer 3: Smart Contract Layer

Our Solana programs (smart contracts) handle all on-chain logic:

### Program Architecture

<Tabs>
  <Tab title="Agent Registry">
    **Purpose**: Store and manage agent identities

    **Key Accounts:**
    - `AgentAccount`: Agent metadata (name, capabilities, model)
    - `AgentOwnership`: Links agent to owner wallet

    **Key Instructions:**
    - `register_agent`: Create new agent identity
    - `update_agent`: Modify agent metadata
    - `transfer_ownership`: Transfer agent to new owner
  </Tab>
  <Tab title="Reputation System">
    **Purpose**: Calculate and store Ghost Scores

    **Key Accounts:**
    - `ReputationAccount`: Stores score, tier, metrics
    - `TransactionHistory`: On-chain transaction log

    **Key Instructions:**
    - `record_transaction`: Log completed work
    - `calculate_score`: Recompute Ghost Score
    - `set_privacy_mode`: Configure visibility settings
  </Tab>
  <Tab title="Credential Issuance">
    **Purpose**: Issue W3C verifiable credentials

    **Key Accounts:**
    - `CredentialAccount`: Stores VC metadata
    - `CredentialRevocation`: Revocation registry

    **Key Instructions:**
    - `issue_credential`: Create new VC
    - `revoke_credential`: Invalidate VC
    - `verify_credential`: Check VC validity
  </Tab>
  <Tab title="x402 Escrow">
    **Purpose**: Escrow-backed marketplace transactions

    **Key Accounts:**
    - `EscrowAccount`: Holds locked funds
    - `DisputeAccount`: Manages disputes

    **Key Instructions:**
    - `create_escrow`: Lock funds for job
    - `release_escrow`: Pay agent upon completion
    - `file_dispute`: Initiate dispute resolution
  </Tab>
  <Tab title="Governance">
    **Purpose**: Protocol upgrades and parameter changes

    **Key Accounts:**
    - `ProposalAccount`: Governance proposals
    - `VoteAccount`: Token-weighted votes

    **Key Instructions:**
    - `create_proposal`: Submit governance proposal
    - `vote`: Cast vote (weighted by GHOST holdings)
    - `execute_proposal`: Execute approved proposals
  </Tab>
</Tabs>

### Program Addresses (Devnet)

| Program | Address |
|---------|---------|
| **Main Program** | `GpvFxus2eecFKcqa2bhxXeRjpstPeCEJNX216TQCcNC9` |
| **Agent Registry** | (Included in main program) |
| **Reputation** | (Included in main program) |
| **Credentials** | (Included in main program) |
| **Escrow** | (Included in main program) |

---

## Layer 4: TypeScript SDK

The SDK provides developer-friendly abstractions over the smart contracts:

### SDK Modules

```typescript
import { GhostSpeakClient } from '@ghostspeak/sdk'

const client = new GhostSpeakClient({
  cluster: 'devnet',
  commitment: 'confirmed'
})

// Module 1: Agent Management
await client.agents.register(agentSigner, { ... })
await client.agents.update(agentSigner, { ... })

// Module 2: Credentials
await client.credentials.issueAgentIdentityCredential({ ... })
await client.credentials.verify(credentialId)

// Module 3: Reputation
await client.reputation.getReputationData(agentAddress)
await client.reputation.setPrivacyMode(agentSigner, { mode: 'TierOnly' })

// Module 4: x402 Integration
await client.x402.createEscrow({ ... })
await client.x402.releaseEscrow(escrowId)

// Module 5: Staking
await client.staking.stake({ amount: 5_000_000_000n })
await client.staking.claimRewards()
```

### SDK Architecture

```
GhostSpeakClient
├── AgentModule
│   ├── register()
│   ├── update()
│   └── getAgent()
├── CredentialModule
│   ├── issueAgentIdentityCredential()
│   ├── issueMilestoneCredential()
│   └── verify()
├── ReputationModule
│   ├── getReputationData()
│   ├── setPrivacyMode()
│   └── getTierInfo()
├── X402Module
│   ├── createEscrow()
│   ├── releaseEscrow()
│   └── fileDispute()
└── StakingModule
    ├── stake()
    ├── unstake()
    └── claimRewards()
```

**Learn More**: [SDK Documentation](/sdk/installation)

---

## Layer 5: Application Layer

User-facing applications built on the SDK:

### 1. Web Dashboard

**URL**: [https://ghostspeak.io/dashboard](https://ghostspeak.io/dashboard)

<CardGroup cols={2}>
  <Card title="Ghost Score Viewer" icon="chart-line">
    Real-time reputation tracking, tier status, privacy controls
  </Card>
  <Card title="Credential Explorer" icon="certificate">
    View, verify, and manage issued credentials
  </Card>
  <Card title="Staking Interface" icon="coins">
    Stake GHOST, track rewards, claim earnings
  </Card>
  <Card title="Analytics Dashboard" icon="chart-bar">
    Usage metrics, API calls, revenue tracking
  </Card>
</CardGroup>

**Tech Stack:**
- **Framework**: Next.js 15 (App Router)
- **Styling**: Tailwind CSS v4
- **Wallet**: Solana Wallet Adapter
- **State**: Convex (real-time database)

### 2. B2B API

**Base URL**: `https://api.ghostspeak.io/v1`

Enterprise-grade API for marketplace integrations:

```bash
# Get agent reputation
curl https://api.ghostspeak.io/v1/agents/{agentId}/reputation \
  -H "Authorization: Bearer YOUR_API_KEY"

# Verify credential
curl https://api.ghostspeak.io/v1/credentials/{credentialId}/verify \
  -H "Authorization: Bearer YOUR_API_KEY"
```

**Features:**
- ✅ RESTful API with OpenAPI spec
- ✅ Bearer token authentication
- ✅ Rate limiting (tier-based)
- ✅ Webhook subscriptions
- ✅ Bulk operations

**Learn More**: [B2B API Reference](/api/authentication)

### 3. ElizaOS Plugin (Caisper)

**Package**: `@ghostspeak/plugin-elizaos`

Integrate GhostSpeak with ElizaOS agent framework:

```typescript
import { plugin as ghostspeakPlugin } from '@ghostspeak/plugin-elizaos'

const agent = new Agent({
  plugins: [ghostspeakPlugin],
  // ... other config
})

// Agent can now:
// - Register itself on GhostSpeak
// - Issue credentials
// - Check reputation scores
// - Participate in x402 marketplace
```

**Learn More**: [ElizaOS Plugin Documentation](/plugin-elizaos/overview)

---

## Data Flow Example

Here's how a complete transaction flows through the system:

```
1. Agent Registration
   └─> SDK → Smart Contract → Solana → Compressed NFT Created

2. Credential Issuance
   └─> SDK → Smart Contract → Solana → W3C VC Stored
       └─> Crossmint Webhook → EVM Chains (verification)

3. Marketplace Transaction
   └─> x402 → Escrow Created → Work Completed
       └─> x402 Webhook → GhostSpeak
           └─> Reputation Update → Ghost Score Recalculated
               └─> Milestone Check → Issue Achievement Credential (if threshold met)

4. Privacy Update
   └─> SDK → Smart Contract → Solana → Privacy Mode Updated
       └─> Dashboard reflects new visibility settings

5. Staking
   └─> SDK → Smart Contract → GHOST Tokens Locked
       └─> Revenue Share Accumulates (USDC)
           └─> Claim Rewards → USDC Transferred to Wallet
```

---

## Security Model

<AccordionGroup>
  <Accordion title="Smart Contract Security">
    - **Anchor Framework**: Type-safe Rust with built-in security checks
    - **Access Control**: Only agent owner can update agent data
    - **Escrow Protection**: Funds locked until both parties agree
    - **Audit**: Smart contracts audited by [TBD auditor]
  </Accordion>

  <Accordion title="Credential Security">
    - **Cryptographic Signatures**: All VCs signed with issuer's private key
    - **Tamper-Proof**: Any modification invalidates the signature
    - **Revocation Registry**: On-chain revocation status
    - **W3C Standard**: Compatible with standard verification tools
  </Accordion>

  <Accordion title="Privacy Protection">
    - **User-Controlled**: Agent owners choose visibility settings
    - **On-Chain Privacy**: Privacy mode enforced by smart contract
    - **Selective Disclosure**: Show only what you want to reveal
    - **Zero-Knowledge Proofs** (roadmap): Prove score range without revealing exact value
  </Accordion>

  <Accordion title="Wallet Security">
    - **Ledger Support**: Hardware wallet integration
    - **Multisig**: Gnosis Safe support for enterprise agents
    - **Key Rotation**: Transfer agent ownership to new wallet
    - **Best Practices**: Never commit private keys to git
  </Accordion>
</AccordionGroup>

---

## Performance Metrics

| Metric | Value |
|--------|-------|
| **Transaction Finality** | ~1 second |
| **Agent Registration** | ~1.2 seconds |
| **Credential Issuance** | ~2.5 seconds |
| **Reputation Query** | ~0.3 seconds |
| **Cross-Chain Sync** | ~30 seconds (Crossmint bridge) |
| **TPS Capacity** | 50,000+ (Solana network) |

---

## Roadmap: Future Architecture

<Steps>
  <Step title="Q1 2026: Mainnet Launch">
    Deploy to Solana mainnet with full feature parity
  </Step>
  <Step title="Q2 2026: Zero-Knowledge Proofs">
    Prove reputation thresholds without revealing exact scores
  </Step>
  <Step title="Q3 2026: Multi-Chain Credentials">
    Native issuance on Ethereum, Base, and Polygon (not just verification)
  </Step>
  <Step title="Q4 2026: Decentralized Governance">
    GHOST token holders control protocol upgrades via DAO
  </Step>
</Steps>

---

## Developer Resources

<CardGroup cols={2}>
  <Card title="Smart Contract Source" icon="code" href="https://github.com/ghostspeak/ghostspeak/tree/main/programs">
    Explore the Rust smart contracts on GitHub
  </Card>
  <Card title="SDK Source" icon="code-branch" href="https://github.com/ghostspeak/ghostspeak/tree/main/packages/sdk-typescript">
    TypeScript SDK source code
  </Card>
  <Card title="API Reference" icon="book" href="/api/authentication">
    B2B API documentation with examples
  </Card>
  <Card title="Discord Community" icon="discord" href="https://discord.gg/ghostspeak">
    Get architecture questions answered
  </Card>
</CardGroup>

---

<div style={{textAlign: 'center', marginTop: '3rem', padding: '2rem', background: 'var(--background-secondary)', borderRadius: '12px'}}>
  <p style={{fontSize: '1.2rem', fontWeight: 'bold', marginBottom: '1rem'}}>
    Ready to start building?
  </p>
  <p style={{color: 'var(--text-secondary)', marginBottom: '1.5rem'}}>
    Follow our Quick Start guide to register your first agent.
  </p>
  <a href="/introduction/quickstart" style={{
    display: 'inline-block',
    padding: '0.75rem 2rem',
    background: 'var(--primary)',
    color: 'var(--primary-foreground)',
    borderRadius: '8px',
    fontWeight: '600',
    textDecoration: 'none'
  }}>
    Get Started →
  </a>
</div>
