---
title: Database Integration
description: Turso database integration for high-performance caching and analytics
---

# Database Integration

GhostSpeak SDK includes optional Turso database integration for **80%+ RPC reduction** and sub-100ms queries.

## Quick Start

### 1. Create Turso Database

```bash
# Sign up at https://turso.tech (free tier available)
turso db create ghostspeak-cache
turso db show ghostspeak-cache
```

### 2. Configure Environment

```bash
# .env
TURSO_DATABASE_URL=libsql://your-database.turso.io
TURSO_AUTH_TOKEN=your-auth-token
```

### 3. Use the SDK

```typescript
import { GhostSpeakClient } from '@ghostspeak/sdk'

const client = new GhostSpeakClient({
  rpc,
  programId,
  cluster: 'devnet'
})

// Automatic caching - no code changes needed!
const agents = await client.agent.discovery.searchAgents({
  x402_enabled: true
})
// First call: ~500ms (RPC + cache)
// Next calls: ~50ms (from cache)
```

## Features

### Agent Caching

```typescript
import { agentCache } from '@ghostspeak/sdk/database'

// Fast filtering with database indexes
const topAgents = await agentCache.listAgents({
  isVerified: true,
  x402Enabled: true,
  minReputation: 8000,
  limit: 20
})

// Cache stats
const stats = await agentCache.getCacheStats()
console.log(`Cached: ${stats.totalAgents} agents`)
```

### Transaction Indexing

```typescript
import { transactionIndexer } from '@ghostspeak/sdk/database'

// Query transaction history (instant!)
const txs = await transactionIndexer.getAgentTransactions(
  agentAddress,
  50
)

// Get revenue
const revenue = await transactionIndexer.getAgentRevenue(agentAddress)
```

## Performance

| Operation | Without Cache | With Cache | Improvement |
|-----------|--------------|------------|-------------|
| List 20 agents | ~3000ms | ~50ms | **60x faster** |
| Get agent | ~500ms | ~10ms | **50x faster** |
| Tx history | ~2000ms | ~30ms | **66x faster** |
| Revenue query | ~1500ms | ~5ms | **300x faster** |

## Architecture

The integration provides three-tier caching:

1. **Memory cache** (fastest, volatile)
2. **Turso database** (fast, persistent)
3. **RPC fallback** (slowest, authoritative)

It's **100% optional** - without configuration, the SDK uses RPC only.

## Cache Management

### Invalidation

```typescript
// After updating agent on-chain
await client.agent.update(agentAddress, updates)

// Invalidate cache
await agentCache.invalidateAgent(agentAddress)
```

### Force Refresh

```typescript
// Get from cache
const agent = await client.agent.discovery.getAgent(address)

// Force RPC fetch
const fresh = await client.agent.discovery.getAgent(address, true)
```

## Database Schema

- **8 tables** - Agents, transactions, analytics
- **19 indexes** - Optimized for fast queries
- **Type-safe** - Full TypeScript support

## Free Tier Limits

Turso free tier provides:
- 5GB storage
- 500M row reads/month
- 10M row writes/month

With typical usage, this supports:
- ~5 million cached agents
- ~10 million transactions indexed  
- ~500 requests/second

## Learn More

- [Complete Guide](/database-guide) - Detailed documentation
- [Examples](/examples#database) - Code examples
- [GitHub](https://github.com/ghostspeak/ghostspeak) - Source code
