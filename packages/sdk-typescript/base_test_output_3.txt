
> @ghostspeak/sdk@2.0.1 test
> vitest run --reporter=verbose tests/unit/client/base-instructions.test.ts

 DEPRECATED  "cache.dir" is deprecated, use Vite's "cacheDir" instead if you want to change the cache director. Note caches will be written to "cacheDir/vitest"

 RUN  v3.2.4 /Users/home/projects/GhostSpeak/packages/sdk-typescript

 √ó tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Building & Sending > should send a basic transaction successfully 6ms
   ‚Üí [Function SimpleRpcClient] is not a spy or a call to a spy!
 ‚úì tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Building & Sending > should send transaction with detailed results 1ms
 ‚úì tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Building & Sending > should handle multiple instructions in a single transaction 0ms
 √ó tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Building & Sending > should validate instructions before sending 2ms
   ‚Üí promise resolved "'mock-signature'" instead of rejecting
 ‚úì tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Building & Sending > should handle transaction errors gracefully 0ms
 √ó tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Building & Sending > should retry with exponential backoff in RPC-only mode 1ms
   ‚Üí expected "spy" to be called 3 times, but got 1 times
 ‚úì tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Building & Sending > should handle subscription-based confirmation when available 1ms
 ‚úì tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Building & Sending > should handle confirmation timeout 0ms
 √ó tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Building & Sending > should log instruction details during debug 2ms
   ‚Üí expected "log" to be called with arguments: [ StringContaining{‚Ä¶} ][90m

Received: 

[1m  1st log call:

[22m[2m  [[22m
[32m-   StringContaining "Debug - Instruction data",[90m
[31m+   "üîç Transaction sent, signature:",[90m
[31m+   "mock-signature",[90m
[2m  ][22m

[1m  2nd log call:

[22m[2m  [[22m
[32m-   StringContaining "Debug - Instruction data",[90m
[31m+   "üîç Signature length:",[90m
[31m+   14,[90m
[2m  ][22m

[1m  3rd log call:

[22m[2m  [[22m
[32m-   StringContaining "Debug - Instruction data",[90m
[31m+   "üîç Signature type:",[90m
[31m+   "string",[90m
[2m  ][22m

[1m  4th log call:

[22m[2m  [[22m
[32m-   StringContaining "Debug - Instruction data",[90m
[31m+   "üîç Confirmation attempt 1/30",[90m
[2m  ][22m

[1m  5th log call:

[22m[2m  [[22m
[32m-   StringContaining "Debug - Instruction data",[90m
[31m+   "üîç Status found:",[90m
[31m+   {[90m
[31m+     "confirmationStatus": "confirmed",[90m
[31m+   },[90m
[2m  ][22m

[1m  6th log call:

[22m[2m  [[22m
[32m-   StringContaining "Debug - Instruction data",[90m
[31m+   "‚úÖ Transaction confirmed via status check",[90m
[2m  ][22m
[39m[90m

Number of calls: [1m6[22m
[39m
 √ó tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Utilities > should estimate transaction cost accurately 0ms
   ‚Üí expected "log" to be called with arguments: [ StringContaining{‚Ä¶} ][90m

Number of calls: [1m0[22m
[39m
 √ó tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Utilities > should fall back to default cost estimation on RPC failure 0ms
   ‚Üí expected "warn" to be called with arguments: [ ‚Ä¶(2) ][90m

Number of calls: [1m0[22m
[39m
 √ó tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Utilities > should simulate transactions before sending 0ms
   ‚Üí expected "log" to be called with arguments: [ StringContaining{‚Ä¶} ][90m

Number of calls: [1m0[22m
[39m
 ‚úì tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Utilities > should handle simulation errors 0ms
 ‚úì tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Utilities > should calculate transaction size correctly 0ms
 √ó tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Utilities > should calculate size for multiple instructions 0ms
   ‚Üí expected 133 to be 355 // Object.is equality
 √ó tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Utilities > should log instruction details 0ms
   ‚Üí expected "log" to be called with arguments: [ 'üìã Instruction Details:' ][90m

Number of calls: [1m0[22m
[39m
 ‚úì tests/unit/client/base-instructions.test.ts > BaseInstructions > Account Operations > should get and decode a single account 1ms
 ‚úì tests/unit/client/base-instructions.test.ts > BaseInstructions > Account Operations > should return null for non-existent accounts 0ms
 √ó tests/unit/client/base-instructions.test.ts > BaseInstructions > Account Operations > should handle decoder not found 0ms
   ‚Üí expected "warn" to be called at least once
 ‚úì tests/unit/client/base-instructions.test.ts > BaseInstructions > Account Operations > should get and decode multiple accounts 1ms
 ‚úì tests/unit/client/base-instructions.test.ts > BaseInstructions > Account Operations > should handle various data formats in account decoding 1ms
 ‚úì tests/unit/client/base-instructions.test.ts > BaseInstructions > Account Operations > should get program accounts with filters 1ms
 √ó tests/unit/client/base-instructions.test.ts > BaseInstructions > Account Operations > should handle decoding errors gracefully in program accounts 1ms
   ‚Üí expected "warn" to be called with arguments: [ ‚Ä¶(2) ][90m

Number of calls: [1m0[22m
[39m
 ‚úì tests/unit/client/base-instructions.test.ts > BaseInstructions > Account Operations > should get raw account data 0ms
 ‚úì tests/unit/client/base-instructions.test.ts > BaseInstructions > Account Operations > should get all program accounts for recovery 0ms
 √ó tests/unit/client/base-instructions.test.ts > BaseInstructions > Account Operations > should handle discriminator validation errors 1ms
   ‚Üí promise resolved "null" instead of rejecting
 ‚úì tests/unit/client/base-instructions.test.ts > BaseInstructions > Execution Helpers > should execute single instruction 0ms
 ‚úì tests/unit/client/base-instructions.test.ts > BaseInstructions > Execution Helpers > should execute instruction with context 0ms
 ‚úì tests/unit/client/base-instructions.test.ts > BaseInstructions > Execution Helpers > should execute instruction with detailed results 0ms
 √ó tests/unit/client/base-instructions.test.ts > BaseInstructions > Execution Helpers > should propagate execution errors with context 1ms
   ‚Üí expected "error" to be called with arguments: [ ‚Ä¶(2) ][90m

Received: 

[1m  1st error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute test operation:",[90m
[32m-   Any<Error>,[90m
[31m+   "üö® GhostSpeak SDK Error:",[90m
[31m+   "Invalid instruction",[90m
[2m  ][22m

[1m  2nd error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute test operation:",[90m
[32m-   Any<Error>,[90m
[31m+   "üîß Operation:",[90m
[31m+   "execute",[90m
[2m  ][22m

[1m  3rd error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute test operation:",[90m
[32m-   Any<Error>,[90m
[31m+   "üìã Instruction:",[90m
[31m+   "test operation",[90m
[2m  ][22m

[1m  4th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute test operation:",[90m
[32m-   Any<Error>,[90m
[31m+   "üè¶ Accounts provided:",[90m
[31m+   1,[90m
[2m  ][22m

[1m  5th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute test operation:",[90m
[32m-   Any<Error>,[90m
[31m+   "  1. TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA (signer)",[90m
[2m  ][22m

[1m  6th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute test operation:",[90m
[32m-   Any<Error>,[90m
[31m+   "‚öôÔ∏è Parameters:",[90m
[31m+   {[90m
[31m+     "programId": "11111111111111111111111111111111",[90m
[31m+   },[90m
[2m  ][22m

[1m  7th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute test operation:",[90m
[32m-   Any<Error>,[90m
[31m+   "[90m
[31m+ üí° Troubleshooting tips:",[90m
[2m  ][22m

[1m  8th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute test operation:",[90m
[32m-   Any<Error>,[90m
[31m+   "  1. Check that all required accounts are provided",[90m
[2m  ][22m

[1m  9th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute test operation:",[90m
[32m-   Any<Error>,[90m
[31m+   "  2. Verify account addresses are correct",[90m
[2m  ][22m

[1m  10th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute test operation:",[90m
[32m-   Any<Error>,[90m
[31m+   "  3. Ensure signers have sufficient SOL for transaction fees",[90m
[2m  ][22m

[1m  11th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute test operation:",[90m
[32m-   Any<Error>,[90m
[31m+   "  4. Confirm the program is deployed on the target network",[90m
[2m  ][22m
[39m[90m

Number of calls: [1m11[22m
[39m
 √ó tests/unit/client/base-instructions.test.ts > BaseInstructions > Execution Helpers > should handle missing context in error messages 1ms
   ‚Üí expected "error" to be called with arguments: [ ‚Ä¶(2) ][90m

Received: 

[1m  1st error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute instruction execution:",[90m
[32m-   Any<Error>,[90m
[31m+   "üö® GhostSpeak SDK Error:",[90m
[31m+   "Generic error",[90m
[2m  ][22m

[1m  2nd error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute instruction execution:",[90m
[32m-   Any<Error>,[90m
[31m+   "üîß Operation:",[90m
[31m+   "execute",[90m
[2m  ][22m

[1m  3rd error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute instruction execution:",[90m
[32m-   Any<Error>,[90m
[31m+   "üìã Instruction:",[90m
[31m+   "test",[90m
[2m  ][22m

[1m  4th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute instruction execution:",[90m
[32m-   Any<Error>,[90m
[31m+   "üè¶ Accounts provided:",[90m
[31m+   1,[90m
[2m  ][22m

[1m  5th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute instruction execution:",[90m
[32m-   Any<Error>,[90m
[31m+   "  1. TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA (signer)",[90m
[2m  ][22m

[1m  6th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute instruction execution:",[90m
[32m-   Any<Error>,[90m
[31m+   "‚öôÔ∏è Parameters:",[90m
[31m+   {[90m
[31m+     "programId": "11111111111111111111111111111111",[90m
[31m+   },[90m
[2m  ][22m

[1m  7th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute instruction execution:",[90m
[32m-   Any<Error>,[90m
[31m+   "[90m
[31m+ üí° Troubleshooting tips:",[90m
[2m  ][22m

[1m  8th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute instruction execution:",[90m
[32m-   Any<Error>,[90m
[31m+   "  1. Check that all required accounts are provided",[90m
[2m  ][22m

[1m  9th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute instruction execution:",[90m
[32m-   Any<Error>,[90m
[31m+   "  2. Verify account addresses are correct",[90m
[2m  ][22m

[1m  10th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute instruction execution:",[90m
[32m-   Any<Error>,[90m
[31m+   "  3. Ensure signers have sufficient SOL for transaction fees",[90m
[2m  ][22m

[1m  11th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute instruction execution:",[90m
[32m-   Any<Error>,[90m
[31m+   "  4. Confirm the program is deployed on the target network",[90m
[2m  ][22m
[39m[90m

Number of calls: [1m11[22m
[39m
 √ó tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Batching > should send multiple transactions in sequence 0ms
   ‚Üí expected "log" to be called with arguments: [ StringContaining{‚Ä¶} ][90m

Number of calls: [1m0[22m
[39m
 √ó tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Batching > should stop batch on first failure 1ms
   ‚Üí promise resolved "[ 'mock-signature', ‚Ä¶(2) ]" instead of rejecting
 √ó tests/unit/client/base-instructions.test.ts > BaseInstructions > Edge Cases and Error Handling > should handle empty instruction arrays 1ms
   ‚Üí Cannot read properties of undefined (reading 'programAddress')
 ‚úì tests/unit/client/base-instructions.test.ts > BaseInstructions > Edge Cases and Error Handling > should handle missing signers 2ms
 √ó tests/unit/client/base-instructions.test.ts > BaseInstructions > Edge Cases and Error Handling > should handle very large instruction data 0ms
   ‚Üí expected "warn" to be called with arguments: [ StringContaining "Transaction size" ][90m

Number of calls: [1m0[22m
[39m
 √ó tests/unit/client/base-instructions.test.ts > BaseInstructions > Edge Cases and Error Handling > should handle RPC endpoint detection fallback 0ms
   ‚Üí Transaction 2 failed
 ‚úì tests/unit/client/base-instructions.test.ts > BaseInstructions > Edge Cases and Error Handling > should handle transaction confirmation with various statuses 1001ms
 ‚úì tests/unit/client/base-instructions.test.ts > BaseInstructions > Edge Cases and Error Handling > should handle transaction errors in confirmation status 1ms
 ‚úì tests/unit/client/base-instructions.test.ts > BaseInstructions > Performance Tests > should handle rapid sequential transactions 0ms
 ‚úì tests/unit/client/base-instructions.test.ts > BaseInstructions > Performance Tests > should efficiently estimate costs for multiple instructions 0ms

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ Failed Tests 19 ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ

 FAIL  tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Building & Sending > should send a basic transaction successfully
TypeError: [Function SimpleRpcClient] is not a spy or a call to a spy!
 ‚ùØ tests/unit/client/base-instructions.test.ts:267:31
    265|       
    266|       expect(signature).toBe('mock-signature')
    267|       expect(SimpleRpcClient).toHaveBeenCalled()
       |                               ^
    268|       expect(consoleLogSpy).toHaveBeenCalledWith(expect.stringContaini‚Ä¶
    269|     })

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[1/19]‚éØ

 FAIL  tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Building & Sending > should validate instructions before sending
AssertionError: promise resolved "'mock-signature'" instead of rejecting

[32m- Expected:[39m 
Error {
  "message": "rejected promise",
}

[31m+ Received:[39m 
"mock-signature"

 ‚ùØ tests/unit/client/base-instructions.test.ts:303:9
    301|         await expect(
    302|           baseInstructions.testSendTransaction([instruction] as any, [‚Ä¶
    303|         ).rejects.toThrow()
       |         ^
    304|       }
    305|     })

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[2/19]‚éØ

 FAIL  tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Building & Sending > should retry with exponential backoff in RPC-only mode
AssertionError: expected "spy" to be called 3 times, but got 1 times
 ‚ùØ tests/unit/client/base-instructions.test.ts:329:58
    327|       const duration = Date.now() - startTime
    328| 
    329|       expect(mockRpcClientInstance.getSignatureStatuses).toHaveBeenCal‚Ä¶
       |                                                          ^
    330|       expect(duration).toBeGreaterThan(1000) // Should have delays
    331|     })

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[3/19]‚éØ

 FAIL  tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Building & Sending > should log instruction details during debug
AssertionError: expected "log" to be called with arguments: [ StringContaining{‚Ä¶} ][90m

Received: 

[1m  1st log call:

[22m[2m  [[22m
[32m-   StringContaining "Debug - Instruction data",[90m
[31m+   "üîç Transaction sent, signature:",[90m
[31m+   "mock-signature",[90m
[2m  ][22m

[1m  2nd log call:

[22m[2m  [[22m
[32m-   StringContaining "Debug - Instruction data",[90m
[31m+   "üîç Signature length:",[90m
[31m+   14,[90m
[2m  ][22m

[1m  3rd log call:

[22m[2m  [[22m
[32m-   StringContaining "Debug - Instruction data",[90m
[31m+   "üîç Signature type:",[90m
[31m+   "string",[90m
[2m  ][22m

[1m  4th log call:

[22m[2m  [[22m
[32m-   StringContaining "Debug - Instruction data",[90m
[31m+   "üîç Confirmation attempt 1/30",[90m
[2m  ][22m

[1m  5th log call:

[22m[2m  [[22m
[32m-   StringContaining "Debug - Instruction data",[90m
[31m+   "üîç Status found:",[90m
[31m+   {[90m
[31m+     "confirmationStatus": "confirmed",[90m
[31m+   },[90m
[2m  ][22m

[1m  6th log call:

[22m[2m  [[22m
[32m-   StringContaining "Debug - Instruction data",[90m
[31m+   "‚úÖ Transaction confirmed via status check",[90m
[2m  ][22m
[39m[90m

Number of calls: [1m6[22m
[39m
 ‚ùØ tests/unit/client/base-instructions.test.ts:354:29
    352|       await baseInstructions.testSendTransaction([mockInstruction], [m‚Ä¶
    353|       
    354|       expect(consoleLogSpy).toHaveBeenCalledWith(expect.stringContaini‚Ä¶
       |                             ^
    355|       expect(consoleLogSpy).toHaveBeenCalledWith(expect.stringContaini‚Ä¶
    356|     })

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[4/19]‚éØ

 FAIL  tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Utilities > should estimate transaction cost accurately
AssertionError: expected "log" to be called with arguments: [ StringContaining{‚Ä¶} ][90m

Number of calls: [1m0[22m
[39m
 ‚ùØ tests/unit/client/base-instructions.test.ts:364:29
    362|       
    363|       expect(cost).toBe(BigInt(5000))
    364|       expect(consoleLogSpy).toHaveBeenCalledWith(expect.stringContaini‚Ä¶
       |                             ^
    365|     })
    366| 

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[5/19]‚éØ

 FAIL  tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Utilities > should fall back to default cost estimation on RPC failure
AssertionError: expected "warn" to be called with arguments: [ ‚Ä¶(2) ][90m

Number of calls: [1m0[22m
[39m
 ‚ùØ tests/unit/client/base-instructions.test.ts:374:30
    372|       
    373|       expect(cost).toBe(BigInt(6000)) // 5000 base + 1000 per instruct‚Ä¶
    374|       expect(consoleWarnSpy).toHaveBeenCalledWith(
       |                              ^
    375|         '‚ö†Ô∏è Real fee estimation failed, using fallback:',
    376|         expect.any(Error)

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[6/19]‚éØ

 FAIL  tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Utilities > should simulate transactions before sending
AssertionError: expected "log" to be called with arguments: [ StringContaining{‚Ä¶} ][90m

Number of calls: [1m0[22m
[39m
 ‚ùØ tests/unit/client/base-instructions.test.ts:390:29
    388|         }
    389|       })
    390|       expect(consoleLogSpy).toHaveBeenCalledWith(expect.stringContaini‚Ä¶
       |                             ^
    391|     })
    392| 

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[7/19]‚éØ

 FAIL  tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Utilities > should calculate size for multiple instructions
AssertionError: expected 133 to be 355 // Object.is equality

[32m- Expected[39m
[31m+ Received[39m

[32m- 355[39m
[31m+ 133[39m

 ‚ùØ tests/unit/client/base-instructions.test.ts:421:20
    419|       
    420|       // 64 + (32*3) + (1+1+3)*32 + (5+10+20)
    421|       expect(size).toBe(355)
       |                    ^
    422|     })
    423| 

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[8/19]‚éØ

 FAIL  tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Utilities > should log instruction details
AssertionError: expected "log" to be called with arguments: [ 'üìã Instruction Details:' ][90m

Number of calls: [1m0[22m
[39m
 ‚ùØ tests/unit/client/base-instructions.test.ts:427:29
    425|       baseInstructions.testLogInstructionDetails(mockInstruction)
    426|       
    427|       expect(consoleLogSpy).toHaveBeenCalledWith('üìã Instruction Detai‚Ä¶
       |                             ^
    428|       expect(consoleLogSpy).toHaveBeenCalledWith(expect.stringContaini‚Ä¶
    429|       expect(consoleLogSpy).toHaveBeenCalledWith(expect.stringContaini‚Ä¶

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[9/19]‚éØ

 FAIL  tests/unit/client/base-instructions.test.ts > BaseInstructions > Account Operations > should handle decoder not found
AssertionError: expected "warn" to be called at least once
 ‚ùØ tests/unit/client/base-instructions.test.ts:509:30
    507| 
    508|       expect(account).toBeNull()
    509|       expect(consoleWarnSpy).toHaveBeenCalled()
       |                              ^
    510|     })
    511| 

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[10/19]‚éØ

 FAIL  tests/unit/client/base-instructions.test.ts > BaseInstructions > Account Operations > should handle decoding errors gracefully in program accounts
AssertionError: expected "warn" to be called with arguments: [ ‚Ä¶(2) ][90m

Number of calls: [1m0[22m
[39m
 ‚ùØ tests/unit/client/base-instructions.test.ts:622:30
    620| 
    621|       expect(accounts).toHaveLength(0)
    622|       expect(consoleWarnSpy).toHaveBeenCalledWith(
       |                              ^
    623|         'Failed to decode account EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGk‚Ä¶
    624|         expect.any(Error)

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[11/19]‚éØ

 FAIL  tests/unit/client/base-instructions.test.ts > BaseInstructions > Account Operations > should handle discriminator validation errors
AssertionError: promise resolved "null" instead of rejecting

[32m- Expected:[39m 
Error {
  "message": "rejected promise",
}

[31m+ Received:[39m 
null

 ‚ùØ tests/unit/client/base-instructions.test.ts:697:7
    695|           'getAgentAccountDecoder'
    696|         )
    697|       ).rejects.toThrow('expected 8 bytes, got 3')
       |       ^
    698|     })
    699|   })

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[12/19]‚éØ

 FAIL  tests/unit/client/base-instructions.test.ts > BaseInstructions > Execution Helpers > should propagate execution errors with context
AssertionError: expected "error" to be called with arguments: [ ‚Ä¶(2) ][90m

Received: 

[1m  1st error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute test operation:",[90m
[32m-   Any<Error>,[90m
[31m+   "üö® GhostSpeak SDK Error:",[90m
[31m+   "Invalid instruction",[90m
[2m  ][22m

[1m  2nd error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute test operation:",[90m
[32m-   Any<Error>,[90m
[31m+   "üîß Operation:",[90m
[31m+   "execute",[90m
[2m  ][22m

[1m  3rd error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute test operation:",[90m
[32m-   Any<Error>,[90m
[31m+   "üìã Instruction:",[90m
[31m+   "test operation",[90m
[2m  ][22m

[1m  4th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute test operation:",[90m
[32m-   Any<Error>,[90m
[31m+   "üè¶ Accounts provided:",[90m
[31m+   1,[90m
[2m  ][22m

[1m  5th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute test operation:",[90m
[32m-   Any<Error>,[90m
[31m+   "  1. TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA (signer)",[90m
[2m  ][22m

[1m  6th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute test operation:",[90m
[32m-   Any<Error>,[90m
[31m+   "‚öôÔ∏è Parameters:",[90m
[31m+   {[90m
[31m+     "programId": "11111111111111111111111111111111",[90m
[31m+   },[90m
[2m  ][22m

[1m  7th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute test operation:",[90m
[32m-   Any<Error>,[90m
[31m+   "[90m
[31m+ üí° Troubleshooting tips:",[90m
[2m  ][22m

[1m  8th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute test operation:",[90m
[32m-   Any<Error>,[90m
[31m+   "  1. Check that all required accounts are provided",[90m
[2m  ][22m

[1m  9th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute test operation:",[90m
[32m-   Any<Error>,[90m
[31m+   "  2. Verify account addresses are correct",[90m
[2m  ][22m

[1m  10th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute test operation:",[90m
[32m-   Any<Error>,[90m
[31m+   "  3. Ensure signers have sufficient SOL for transaction fees",[90m
[2m  ][22m

[1m  11th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute test operation:",[90m
[32m-   Any<Error>,[90m
[31m+   "  4. Confirm the program is deployed on the target network",[90m
[2m  ][22m
[39m[90m

Number of calls: [1m11[22m
[39m
 ‚ùØ tests/unit/client/base-instructions.test.ts:735:31
    733|       ).rejects.toThrow('Invalid instruction')
    734| 
    735|       expect(consoleErrorSpy).toHaveBeenCalledWith(
       |                               ^
    736|         '‚ùå Failed to execute test operation:',
    737|         expect.any(Error)

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[13/19]‚éØ

 FAIL  tests/unit/client/base-instructions.test.ts > BaseInstructions > Execution Helpers > should handle missing context in error messages
AssertionError: expected "error" to be called with arguments: [ ‚Ä¶(2) ][90m

Received: 

[1m  1st error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute instruction execution:",[90m
[32m-   Any<Error>,[90m
[31m+   "üö® GhostSpeak SDK Error:",[90m
[31m+   "Generic error",[90m
[2m  ][22m

[1m  2nd error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute instruction execution:",[90m
[32m-   Any<Error>,[90m
[31m+   "üîß Operation:",[90m
[31m+   "execute",[90m
[2m  ][22m

[1m  3rd error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute instruction execution:",[90m
[32m-   Any<Error>,[90m
[31m+   "üìã Instruction:",[90m
[31m+   "test",[90m
[2m  ][22m

[1m  4th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute instruction execution:",[90m
[32m-   Any<Error>,[90m
[31m+   "üè¶ Accounts provided:",[90m
[31m+   1,[90m
[2m  ][22m

[1m  5th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute instruction execution:",[90m
[32m-   Any<Error>,[90m
[31m+   "  1. TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA (signer)",[90m
[2m  ][22m

[1m  6th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute instruction execution:",[90m
[32m-   Any<Error>,[90m
[31m+   "‚öôÔ∏è Parameters:",[90m
[31m+   {[90m
[31m+     "programId": "11111111111111111111111111111111",[90m
[31m+   },[90m
[2m  ][22m

[1m  7th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute instruction execution:",[90m
[32m-   Any<Error>,[90m
[31m+   "[90m
[31m+ üí° Troubleshooting tips:",[90m
[2m  ][22m

[1m  8th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute instruction execution:",[90m
[32m-   Any<Error>,[90m
[31m+   "  1. Check that all required accounts are provided",[90m
[2m  ][22m

[1m  9th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute instruction execution:",[90m
[32m-   Any<Error>,[90m
[31m+   "  2. Verify account addresses are correct",[90m
[2m  ][22m

[1m  10th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute instruction execution:",[90m
[32m-   Any<Error>,[90m
[31m+   "  3. Ensure signers have sufficient SOL for transaction fees",[90m
[2m  ][22m

[1m  11th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute instruction execution:",[90m
[32m-   Any<Error>,[90m
[31m+   "  4. Confirm the program is deployed on the target network",[90m
[2m  ][22m
[39m[90m

Number of calls: [1m11[22m
[39m
 ‚ùØ tests/unit/client/base-instructions.test.ts:748:31
    746|       ).rejects.toThrow('Generic error')
    747| 
    748|       expect(consoleErrorSpy).toHaveBeenCalledWith(
       |                               ^
    749|         '‚ùå Failed to execute instruction execution:',
    750|         expect.any(Error)

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[14/19]‚éØ

 FAIL  tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Batching > should send multiple transactions in sequence
AssertionError: expected "log" to be called with arguments: [ StringContaining{‚Ä¶} ][90m

Number of calls: [1m0[22m
[39m
 ‚ùØ tests/unit/client/base-instructions.test.ts:767:29
    765|       expect(signatures).toHaveLength(3)
    766|       expect(signatures.every(sig => sig === 'mock-signature')).toBe(t‚Ä¶
    767|       expect(consoleLogSpy).toHaveBeenCalledWith(expect.stringContaini‚Ä¶
       |                             ^
    768|       expect(consoleLogSpy).toHaveBeenCalledWith(expect.stringContaini‚Ä¶
    769|     })

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[15/19]‚éØ

 FAIL  tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Batching > should stop batch on first failure
AssertionError: promise resolved "[ 'mock-signature', ‚Ä¶(2) ]" instead of rejecting

[32m- Expected:[39m 
Error {
  "message": "rejected promise",
}

[31m+ Received:[39m 
[
  "mock-signature",
  "mock-signature",
  "mock-signature",
]

 ‚ùØ tests/unit/client/base-instructions.test.ts:797:7
    795|       await expect(
    796|         baseInstructions.testSendTransactionBatch(batches, [mockSigner‚Ä¶
    797|       ).rejects.toThrow('Batch transaction 2 failed')
       |       ^
    798| 
    799|       expect(consoleErrorSpy).toHaveBeenCalledWith(

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[16/19]‚éØ

 FAIL  tests/unit/client/base-instructions.test.ts > BaseInstructions > Edge Cases and Error Handling > should handle empty instruction arrays
TypeError: Cannot read properties of undefined (reading 'programAddress')
 ‚ùØ validateInstruction src/core/InstructionBuilder.ts:36:13
     34| function validateInstruction(instruction: unknown): asserts instructio‚Ä¶
     35|   const inst = instruction as Record<string, unknown>
     36|   if (!inst.programAddress) {
       |             ^
     37|     throw new Error('Invalid instruction format')
     38|   }
 ‚ùØ InstructionBuilder.execute src/core/InstructionBuilder.ts:90:7

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[17/19]‚éØ

 FAIL  tests/unit/client/base-instructions.test.ts > BaseInstructions > Edge Cases and Error Handling > should handle very large instruction data
AssertionError: expected "warn" to be called with arguments: [ StringContaining "Transaction size" ][90m

Number of calls: [1m0[22m
[39m
 ‚ùØ tests/unit/client/base-instructions.test.ts:853:30
    851|       await baseInstructions.testSendTransaction([largeInstruction], [‚Ä¶
    852|       
    853|       expect(consoleWarnSpy).toHaveBeenCalledWith(expect.stringContain‚Ä¶
       |                              ^
    854|     })
    855| 

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[18/19]‚éØ

 FAIL  tests/unit/client/base-instructions.test.ts > BaseInstructions > Edge Cases and Error Handling > should handle RPC endpoint detection fallback
Error: Transaction 2 failed
 ‚ùØ tests/unit/client/base-instructions.test.ts:778:32
    776|       mockRpcClientInstance.sendTransaction
    777|         .mockResolvedValueOnce('sig1')
    778|         .mockRejectedValueOnce(new Error('Transaction 2 failed'))
       |                                ^
    779|         .mockResolvedValueOnce('sig3')
    780| 

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[19/19]‚éØ


 Test Files  1 failed (1)
      Tests  19 failed | 22 passed (41)
   Start at  16:46:30
   Duration  1.30s (transform 146ms, setup 20ms, collect 151ms, tests 1.03s, environment 0ms, prepare 36ms)

npm error Lifecycle script `test` failed with error:
npm error code 1
npm error path /Users/home/projects/GhostSpeak/packages/sdk-typescript
npm error workspace @ghostspeak/sdk@2.0.1
npm error location /Users/home/projects/GhostSpeak/packages/sdk-typescript
npm error command failed
npm error command sh -c vitest run --reporter=verbose tests/unit/client/base-instructions.test.ts
