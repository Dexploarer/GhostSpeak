
> @ghostspeak/sdk@2.0.1 test
> vitest run --reporter=verbose tests/unit/client/base-instructions.test.ts

 DEPRECATED  "cache.dir" is deprecated, use Vite's "cacheDir" instead if you want to change the cache director. Note caches will be written to "cacheDir/vitest"

 RUN  v3.2.4 /Users/home/projects/GhostSpeak/packages/sdk-typescript

 ‚úì tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Building & Sending > should send a basic transaction successfully 2ms
 ‚úì tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Building & Sending > should send transaction with detailed results 0ms
 ‚úì tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Building & Sending > should handle multiple instructions in a single transaction 0ms
 ‚úì tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Building & Sending > should validate instructions before sending 1ms
 ‚úì tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Building & Sending > should handle transaction errors gracefully 0ms
 √ó tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Building & Sending > should retry with exponential backoff in RPC-only mode 3ms
   ‚Üí this.confirmTransaction is not a function
 ‚úì tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Building & Sending > should handle subscription-based confirmation when available 0ms
 ‚úì tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Building & Sending > should handle confirmation timeout 0ms
 √ó tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Building & Sending > should log instruction details during debug 3ms
   ‚Üí expected "log" to be called with arguments: [ StringContaining{‚Ä¶} ][90m

Received: 

[1m  1st log call:

[22m[2m  [[22m
[32m-   StringContaining "Debug - Instruction data",[90m
[31m+   "üîç Transaction sent, signature:",[90m
[31m+   "mock-signature",[90m
[2m  ][22m

[1m  2nd log call:

[22m[2m  [[22m
[32m-   StringContaining "Debug - Instruction data",[90m
[31m+   "üîç Signature length:",[90m
[31m+   14,[90m
[2m  ][22m

[1m  3rd log call:

[22m[2m  [[22m
[32m-   StringContaining "Debug - Instruction data",[90m
[31m+   "üîç Signature type:",[90m
[31m+   "string",[90m
[2m  ][22m

[1m  4th log call:

[22m[2m  [[22m
[32m-   StringContaining "Debug - Instruction data",[90m
[31m+   "üîç Confirmation attempt 1/30",[90m
[2m  ][22m

[1m  5th log call:

[22m[2m  [[22m
[32m-   StringContaining "Debug - Instruction data",[90m
[31m+   "üîç No status found, trying transaction details...",[90m
[2m  ][22m

[1m  6th log call:

[22m[2m  [[22m
[32m-   StringContaining "Debug - Instruction data",[90m
[31m+   "‚úÖ Transaction confirmed via direct lookup",[90m
[2m  ][22m
[39m[90m

Number of calls: [1m6[22m
[39m
 √ó tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Utilities > should estimate transaction cost accurately 0ms
   ‚Üí expected "log" to be called with arguments: [ StringContaining{‚Ä¶} ][90m

Number of calls: [1m0[22m
[39m
 √ó tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Utilities > should fall back to default cost estimation on RPC failure 0ms
   ‚Üí expected "warn" to be called with arguments: [ ‚Ä¶(2) ][90m

Number of calls: [1m0[22m
[39m
 √ó tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Utilities > should simulate transactions before sending 1ms
   ‚Üí expected "log" to be called with arguments: [ StringContaining{‚Ä¶} ][90m

Number of calls: [1m0[22m
[39m
 ‚úì tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Utilities > should handle simulation errors 0ms
 ‚úì tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Utilities > should calculate transaction size correctly 0ms
 ‚úì tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Utilities > should calculate size for multiple instructions 0ms
 √ó tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Utilities > should log instruction details 0ms
   ‚Üí expected "log" to be called with arguments: [ 'üìã Instruction Details:' ][90m

Number of calls: [1m0[22m
[39m
 ‚úì tests/unit/client/base-instructions.test.ts > BaseInstructions > Account Operations > should get and decode a single account 1ms
 ‚úì tests/unit/client/base-instructions.test.ts > BaseInstructions > Account Operations > should return null for non-existent accounts 0ms
 √ó tests/unit/client/base-instructions.test.ts > BaseInstructions > Account Operations > should handle decoder not found 0ms
   ‚Üí expected "warn" to be called at least once
 ‚úì tests/unit/client/base-instructions.test.ts > BaseInstructions > Account Operations > should get and decode multiple accounts 1ms
 ‚úì tests/unit/client/base-instructions.test.ts > BaseInstructions > Account Operations > should handle various data formats in account decoding 1ms
 ‚úì tests/unit/client/base-instructions.test.ts > BaseInstructions > Account Operations > should get program accounts with filters 1ms
 √ó tests/unit/client/base-instructions.test.ts > BaseInstructions > Account Operations > should handle decoding errors gracefully in program accounts 1ms
   ‚Üí expected "warn" to be called with arguments: [ ‚Ä¶(2) ][90m

Number of calls: [1m0[22m
[39m
 ‚úì tests/unit/client/base-instructions.test.ts > BaseInstructions > Account Operations > should get raw account data 0ms
 ‚úì tests/unit/client/base-instructions.test.ts > BaseInstructions > Account Operations > should get all program accounts for recovery 0ms
 √ó tests/unit/client/base-instructions.test.ts > BaseInstructions > Account Operations > should handle discriminator validation errors 1ms
   ‚Üí promise resolved "null" instead of rejecting
 ‚úì tests/unit/client/base-instructions.test.ts > BaseInstructions > Execution Helpers > should execute single instruction 0ms
 ‚úì tests/unit/client/base-instructions.test.ts > BaseInstructions > Execution Helpers > should execute instruction with context 0ms
 ‚úì tests/unit/client/base-instructions.test.ts > BaseInstructions > Execution Helpers > should execute instruction with detailed results 0ms
 √ó tests/unit/client/base-instructions.test.ts > BaseInstructions > Execution Helpers > should propagate execution errors with context 1ms
   ‚Üí expected "error" to be called with arguments: [ ‚Ä¶(2) ][90m

Received: 

[1m  1st error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute test operation:",[90m
[32m-   Any<Error>,[90m
[31m+   "üö® GhostSpeak SDK Error:",[90m
[31m+   "Invalid instruction",[90m
[2m  ][22m

[1m  2nd error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute test operation:",[90m
[32m-   Any<Error>,[90m
[31m+   "üîß Operation:",[90m
[31m+   "execute",[90m
[2m  ][22m

[1m  3rd error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute test operation:",[90m
[32m-   Any<Error>,[90m
[31m+   "üìã Instruction:",[90m
[31m+   "test operation",[90m
[2m  ][22m

[1m  4th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute test operation:",[90m
[32m-   Any<Error>,[90m
[31m+   "üè¶ Accounts provided:",[90m
[31m+   1,[90m
[2m  ][22m

[1m  5th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute test operation:",[90m
[32m-   Any<Error>,[90m
[31m+   "  1. TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA (signer)",[90m
[2m  ][22m

[1m  6th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute test operation:",[90m
[32m-   Any<Error>,[90m
[31m+   "‚öôÔ∏è Parameters:",[90m
[31m+   {[90m
[31m+     "programId": "11111111111111111111111111111111",[90m
[31m+   },[90m
[2m  ][22m

[1m  7th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute test operation:",[90m
[32m-   Any<Error>,[90m
[31m+   "[90m
[31m+ üí° Troubleshooting tips:",[90m
[2m  ][22m

[1m  8th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute test operation:",[90m
[32m-   Any<Error>,[90m
[31m+   "  1. Check that all required accounts are provided",[90m
[2m  ][22m

[1m  9th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute test operation:",[90m
[32m-   Any<Error>,[90m
[31m+   "  2. Verify account addresses are correct",[90m
[2m  ][22m

[1m  10th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute test operation:",[90m
[32m-   Any<Error>,[90m
[31m+   "  3. Ensure signers have sufficient SOL for transaction fees",[90m
[2m  ][22m

[1m  11th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute test operation:",[90m
[32m-   Any<Error>,[90m
[31m+   "  4. Confirm the program is deployed on the target network",[90m
[2m  ][22m
[39m[90m

Number of calls: [1m11[22m
[39m
 √ó tests/unit/client/base-instructions.test.ts > BaseInstructions > Execution Helpers > should handle missing context in error messages 1ms
   ‚Üí expected "error" to be called with arguments: [ ‚Ä¶(2) ][90m

Received: 

[1m  1st error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute instruction execution:",[90m
[32m-   Any<Error>,[90m
[31m+   "üö® GhostSpeak SDK Error:",[90m
[31m+   "Generic error",[90m
[2m  ][22m

[1m  2nd error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute instruction execution:",[90m
[32m-   Any<Error>,[90m
[31m+   "üîß Operation:",[90m
[31m+   "execute",[90m
[2m  ][22m

[1m  3rd error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute instruction execution:",[90m
[32m-   Any<Error>,[90m
[31m+   "üìã Instruction:",[90m
[31m+   "test",[90m
[2m  ][22m

[1m  4th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute instruction execution:",[90m
[32m-   Any<Error>,[90m
[31m+   "üè¶ Accounts provided:",[90m
[31m+   1,[90m
[2m  ][22m

[1m  5th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute instruction execution:",[90m
[32m-   Any<Error>,[90m
[31m+   "  1. TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA (signer)",[90m
[2m  ][22m

[1m  6th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute instruction execution:",[90m
[32m-   Any<Error>,[90m
[31m+   "‚öôÔ∏è Parameters:",[90m
[31m+   {[90m
[31m+     "programId": "11111111111111111111111111111111",[90m
[31m+   },[90m
[2m  ][22m

[1m  7th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute instruction execution:",[90m
[32m-   Any<Error>,[90m
[31m+   "[90m
[31m+ üí° Troubleshooting tips:",[90m
[2m  ][22m

[1m  8th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute instruction execution:",[90m
[32m-   Any<Error>,[90m
[31m+   "  1. Check that all required accounts are provided",[90m
[2m  ][22m

[1m  9th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute instruction execution:",[90m
[32m-   Any<Error>,[90m
[31m+   "  2. Verify account addresses are correct",[90m
[2m  ][22m

[1m  10th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute instruction execution:",[90m
[32m-   Any<Error>,[90m
[31m+   "  3. Ensure signers have sufficient SOL for transaction fees",[90m
[2m  ][22m

[1m  11th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute instruction execution:",[90m
[32m-   Any<Error>,[90m
[31m+   "  4. Confirm the program is deployed on the target network",[90m
[2m  ][22m
[39m[90m

Number of calls: [1m11[22m
[39m
 √ó tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Batching > should send multiple transactions in sequence 0ms
   ‚Üí expected "log" to be called with arguments: [ StringContaining{‚Ä¶} ][90m

Number of calls: [1m0[22m
[39m
 √ó tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Batching > should stop batch on first failure 0ms
   ‚Üí promise resolved "[ 'mock-signature', ‚Ä¶(2) ]" instead of rejecting
 √ó tests/unit/client/base-instructions.test.ts > BaseInstructions > Edge Cases and Error Handling > should handle empty instruction arrays 1ms
   ‚Üí Cannot read properties of undefined (reading 'programAddress')
 ‚úì tests/unit/client/base-instructions.test.ts > BaseInstructions > Edge Cases and Error Handling > should handle missing signers 0ms
 √ó tests/unit/client/base-instructions.test.ts > BaseInstructions > Edge Cases and Error Handling > should handle very large instruction data 1ms
   ‚Üí expected "warn" to be called with arguments: [ StringContaining "Transaction size" ][90m

Number of calls: [1m0[22m
[39m
 √ó tests/unit/client/base-instructions.test.ts > BaseInstructions > Edge Cases and Error Handling > should handle RPC endpoint detection fallback 0ms
   ‚Üí Transaction 2 failed
 ‚úì tests/unit/client/base-instructions.test.ts > BaseInstructions > Edge Cases and Error Handling > should handle transaction confirmation with various statuses 1001ms
 ‚úì tests/unit/client/base-instructions.test.ts > BaseInstructions > Edge Cases and Error Handling > should handle transaction errors in confirmation status 1ms
 ‚úì tests/unit/client/base-instructions.test.ts > BaseInstructions > Performance Tests > should handle rapid sequential transactions 0ms
 ‚úì tests/unit/client/base-instructions.test.ts > BaseInstructions > Performance Tests > should efficiently estimate costs for multiple instructions 0ms

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ Failed Tests 16 ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ

 FAIL  tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Building & Sending > should retry with exponential backoff in RPC-only mode
TypeError: this.confirmTransaction is not a function
 ‚ùØ TestInstructions.testConfirmTransaction tests/unit/client/base-instructions.test.ts:180:17
    178|     commitment: any = 'confirmed'
    179|   ): Promise<TransactionResult> {
    180|     return this.confirmTransaction(signature, commitment)
       |                 ^
    181|   }
    182| 
 ‚ùØ tests/unit/client/base-instructions.test.ts:325:30

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[1/16]‚éØ

 FAIL  tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Building & Sending > should log instruction details during debug
AssertionError: expected "log" to be called with arguments: [ StringContaining{‚Ä¶} ][90m

Received: 

[1m  1st log call:

[22m[2m  [[22m
[32m-   StringContaining "Debug - Instruction data",[90m
[31m+   "üîç Transaction sent, signature:",[90m
[31m+   "mock-signature",[90m
[2m  ][22m

[1m  2nd log call:

[22m[2m  [[22m
[32m-   StringContaining "Debug - Instruction data",[90m
[31m+   "üîç Signature length:",[90m
[31m+   14,[90m
[2m  ][22m

[1m  3rd log call:

[22m[2m  [[22m
[32m-   StringContaining "Debug - Instruction data",[90m
[31m+   "üîç Signature type:",[90m
[31m+   "string",[90m
[2m  ][22m

[1m  4th log call:

[22m[2m  [[22m
[32m-   StringContaining "Debug - Instruction data",[90m
[31m+   "üîç Confirmation attempt 1/30",[90m
[2m  ][22m

[1m  5th log call:

[22m[2m  [[22m
[32m-   StringContaining "Debug - Instruction data",[90m
[31m+   "üîç No status found, trying transaction details...",[90m
[2m  ][22m

[1m  6th log call:

[22m[2m  [[22m
[32m-   StringContaining "Debug - Instruction data",[90m
[31m+   "‚úÖ Transaction confirmed via direct lookup",[90m
[2m  ][22m
[39m[90m

Number of calls: [1m6[22m
[39m
 ‚ùØ tests/unit/client/base-instructions.test.ts:353:29
    351|       await baseInstructions.testSendTransaction([mockInstruction], [m‚Ä¶
    352|       
    353|       expect(consoleLogSpy).toHaveBeenCalledWith(expect.stringContaini‚Ä¶
       |                             ^
    354|       expect(consoleLogSpy).toHaveBeenCalledWith(expect.stringContaini‚Ä¶
    355|     })

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[2/16]‚éØ

 FAIL  tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Utilities > should estimate transaction cost accurately
AssertionError: expected "log" to be called with arguments: [ StringContaining{‚Ä¶} ][90m

Number of calls: [1m0[22m
[39m
 ‚ùØ tests/unit/client/base-instructions.test.ts:363:29
    361|       
    362|       expect(cost).toBe(BigInt(5000))
    363|       expect(consoleLogSpy).toHaveBeenCalledWith(expect.stringContaini‚Ä¶
       |                             ^
    364|     })
    365| 

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[3/16]‚éØ

 FAIL  tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Utilities > should fall back to default cost estimation on RPC failure
AssertionError: expected "warn" to be called with arguments: [ ‚Ä¶(2) ][90m

Number of calls: [1m0[22m
[39m
 ‚ùØ tests/unit/client/base-instructions.test.ts:373:30
    371|       
    372|       expect(cost).toBe(BigInt(6000)) // 5000 base + 1000 per instruct‚Ä¶
    373|       expect(consoleWarnSpy).toHaveBeenCalledWith(
       |                              ^
    374|         '‚ö†Ô∏è Real fee estimation failed, using fallback:',
    375|         expect.any(Error)

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[4/16]‚éØ

 FAIL  tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Utilities > should simulate transactions before sending
AssertionError: expected "log" to be called with arguments: [ StringContaining{‚Ä¶} ][90m

Number of calls: [1m0[22m
[39m
 ‚ùØ tests/unit/client/base-instructions.test.ts:389:29
    387|         }
    388|       })
    389|       expect(consoleLogSpy).toHaveBeenCalledWith(expect.stringContaini‚Ä¶
       |                             ^
    390|     })
    391| 

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[5/16]‚éØ

 FAIL  tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Utilities > should log instruction details
AssertionError: expected "log" to be called with arguments: [ 'üìã Instruction Details:' ][90m

Number of calls: [1m0[22m
[39m
 ‚ùØ tests/unit/client/base-instructions.test.ts:425:29
    423|       baseInstructions.testLogInstructionDetails(mockInstruction)
    424|       
    425|       expect(consoleLogSpy).toHaveBeenCalledWith('üìã Instruction Detai‚Ä¶
       |                             ^
    426|       expect(consoleLogSpy).toHaveBeenCalledWith(expect.stringContaini‚Ä¶
    427|       expect(consoleLogSpy).toHaveBeenCalledWith(expect.stringContaini‚Ä¶

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[6/16]‚éØ

 FAIL  tests/unit/client/base-instructions.test.ts > BaseInstructions > Account Operations > should handle decoder not found
AssertionError: expected "warn" to be called at least once
 ‚ùØ tests/unit/client/base-instructions.test.ts:507:30
    505| 
    506|       expect(account).toBeNull()
    507|       expect(consoleWarnSpy).toHaveBeenCalled()
       |                              ^
    508|     })
    509| 

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[7/16]‚éØ

 FAIL  tests/unit/client/base-instructions.test.ts > BaseInstructions > Account Operations > should handle decoding errors gracefully in program accounts
AssertionError: expected "warn" to be called with arguments: [ ‚Ä¶(2) ][90m

Number of calls: [1m0[22m
[39m
 ‚ùØ tests/unit/client/base-instructions.test.ts:620:30
    618| 
    619|       expect(accounts).toHaveLength(0)
    620|       expect(consoleWarnSpy).toHaveBeenCalledWith(
       |                              ^
    621|         'Failed to decode account EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGk‚Ä¶
    622|         expect.any(Error)

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[8/16]‚éØ

 FAIL  tests/unit/client/base-instructions.test.ts > BaseInstructions > Account Operations > should handle discriminator validation errors
AssertionError: promise resolved "null" instead of rejecting

[32m- Expected:[39m 
Error {
  "message": "rejected promise",
}

[31m+ Received:[39m 
null

 ‚ùØ tests/unit/client/base-instructions.test.ts:695:7
    693|           'getAgentAccountDecoder'
    694|         )
    695|       ).rejects.toThrow('expected 8 bytes, got 3')
       |       ^
    696|     })
    697|   })

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[9/16]‚éØ

 FAIL  tests/unit/client/base-instructions.test.ts > BaseInstructions > Execution Helpers > should propagate execution errors with context
AssertionError: expected "error" to be called with arguments: [ ‚Ä¶(2) ][90m

Received: 

[1m  1st error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute test operation:",[90m
[32m-   Any<Error>,[90m
[31m+   "üö® GhostSpeak SDK Error:",[90m
[31m+   "Invalid instruction",[90m
[2m  ][22m

[1m  2nd error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute test operation:",[90m
[32m-   Any<Error>,[90m
[31m+   "üîß Operation:",[90m
[31m+   "execute",[90m
[2m  ][22m

[1m  3rd error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute test operation:",[90m
[32m-   Any<Error>,[90m
[31m+   "üìã Instruction:",[90m
[31m+   "test operation",[90m
[2m  ][22m

[1m  4th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute test operation:",[90m
[32m-   Any<Error>,[90m
[31m+   "üè¶ Accounts provided:",[90m
[31m+   1,[90m
[2m  ][22m

[1m  5th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute test operation:",[90m
[32m-   Any<Error>,[90m
[31m+   "  1. TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA (signer)",[90m
[2m  ][22m

[1m  6th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute test operation:",[90m
[32m-   Any<Error>,[90m
[31m+   "‚öôÔ∏è Parameters:",[90m
[31m+   {[90m
[31m+     "programId": "11111111111111111111111111111111",[90m
[31m+   },[90m
[2m  ][22m

[1m  7th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute test operation:",[90m
[32m-   Any<Error>,[90m
[31m+   "[90m
[31m+ üí° Troubleshooting tips:",[90m
[2m  ][22m

[1m  8th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute test operation:",[90m
[32m-   Any<Error>,[90m
[31m+   "  1. Check that all required accounts are provided",[90m
[2m  ][22m

[1m  9th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute test operation:",[90m
[32m-   Any<Error>,[90m
[31m+   "  2. Verify account addresses are correct",[90m
[2m  ][22m

[1m  10th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute test operation:",[90m
[32m-   Any<Error>,[90m
[31m+   "  3. Ensure signers have sufficient SOL for transaction fees",[90m
[2m  ][22m

[1m  11th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute test operation:",[90m
[32m-   Any<Error>,[90m
[31m+   "  4. Confirm the program is deployed on the target network",[90m
[2m  ][22m
[39m[90m

Number of calls: [1m11[22m
[39m
 ‚ùØ tests/unit/client/base-instructions.test.ts:733:31
    731|       ).rejects.toThrow('Invalid instruction')
    732| 
    733|       expect(consoleErrorSpy).toHaveBeenCalledWith(
       |                               ^
    734|         '‚ùå Failed to execute test operation:',
    735|         expect.any(Error)

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[10/16]‚éØ

 FAIL  tests/unit/client/base-instructions.test.ts > BaseInstructions > Execution Helpers > should handle missing context in error messages
AssertionError: expected "error" to be called with arguments: [ ‚Ä¶(2) ][90m

Received: 

[1m  1st error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute instruction execution:",[90m
[32m-   Any<Error>,[90m
[31m+   "üö® GhostSpeak SDK Error:",[90m
[31m+   "Generic error",[90m
[2m  ][22m

[1m  2nd error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute instruction execution:",[90m
[32m-   Any<Error>,[90m
[31m+   "üîß Operation:",[90m
[31m+   "execute",[90m
[2m  ][22m

[1m  3rd error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute instruction execution:",[90m
[32m-   Any<Error>,[90m
[31m+   "üìã Instruction:",[90m
[31m+   "test",[90m
[2m  ][22m

[1m  4th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute instruction execution:",[90m
[32m-   Any<Error>,[90m
[31m+   "üè¶ Accounts provided:",[90m
[31m+   1,[90m
[2m  ][22m

[1m  5th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute instruction execution:",[90m
[32m-   Any<Error>,[90m
[31m+   "  1. TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA (signer)",[90m
[2m  ][22m

[1m  6th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute instruction execution:",[90m
[32m-   Any<Error>,[90m
[31m+   "‚öôÔ∏è Parameters:",[90m
[31m+   {[90m
[31m+     "programId": "11111111111111111111111111111111",[90m
[31m+   },[90m
[2m  ][22m

[1m  7th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute instruction execution:",[90m
[32m-   Any<Error>,[90m
[31m+   "[90m
[31m+ üí° Troubleshooting tips:",[90m
[2m  ][22m

[1m  8th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute instruction execution:",[90m
[32m-   Any<Error>,[90m
[31m+   "  1. Check that all required accounts are provided",[90m
[2m  ][22m

[1m  9th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute instruction execution:",[90m
[32m-   Any<Error>,[90m
[31m+   "  2. Verify account addresses are correct",[90m
[2m  ][22m

[1m  10th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute instruction execution:",[90m
[32m-   Any<Error>,[90m
[31m+   "  3. Ensure signers have sufficient SOL for transaction fees",[90m
[2m  ][22m

[1m  11th error call:

[22m[2m  [[22m
[32m-   "‚ùå Failed to execute instruction execution:",[90m
[32m-   Any<Error>,[90m
[31m+   "  4. Confirm the program is deployed on the target network",[90m
[2m  ][22m
[39m[90m

Number of calls: [1m11[22m
[39m
 ‚ùØ tests/unit/client/base-instructions.test.ts:746:31
    744|       ).rejects.toThrow('Generic error')
    745| 
    746|       expect(consoleErrorSpy).toHaveBeenCalledWith(
       |                               ^
    747|         '‚ùå Failed to execute instruction execution:',
    748|         expect.any(Error)

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[11/16]‚éØ

 FAIL  tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Batching > should send multiple transactions in sequence
AssertionError: expected "log" to be called with arguments: [ StringContaining{‚Ä¶} ][90m

Number of calls: [1m0[22m
[39m
 ‚ùØ tests/unit/client/base-instructions.test.ts:765:29
    763|       expect(signatures).toHaveLength(3)
    764|       expect(signatures.every(sig => sig === 'mock-signature')).toBe(t‚Ä¶
    765|       expect(consoleLogSpy).toHaveBeenCalledWith(expect.stringContaini‚Ä¶
       |                             ^
    766|       expect(consoleLogSpy).toHaveBeenCalledWith(expect.stringContaini‚Ä¶
    767|     })

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[12/16]‚éØ

 FAIL  tests/unit/client/base-instructions.test.ts > BaseInstructions > Transaction Batching > should stop batch on first failure
AssertionError: promise resolved "[ 'mock-signature', ‚Ä¶(2) ]" instead of rejecting

[32m- Expected:[39m 
Error {
  "message": "rejected promise",
}

[31m+ Received:[39m 
[
  "mock-signature",
  "mock-signature",
  "mock-signature",
]

 ‚ùØ tests/unit/client/base-instructions.test.ts:795:7
    793|       await expect(
    794|         baseInstructions.testSendTransactionBatch(batches, [mockSigner‚Ä¶
    795|       ).rejects.toThrow('Batch transaction 2 failed')
       |       ^
    796| 
    797|       expect(consoleErrorSpy).toHaveBeenCalledWith(

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[13/16]‚éØ

 FAIL  tests/unit/client/base-instructions.test.ts > BaseInstructions > Edge Cases and Error Handling > should handle empty instruction arrays
TypeError: Cannot read properties of undefined (reading 'programAddress')
 ‚ùØ validateInstruction src/core/InstructionBuilder.ts:36:13
     34| function validateInstruction(instruction: unknown): asserts instructio‚Ä¶
     35|   const inst = instruction as Record<string, unknown>
     36|   if (!inst.programAddress) {
       |             ^
     37|     throw new Error('Invalid instruction format')
     38|   }
 ‚ùØ InstructionBuilder.execute src/core/InstructionBuilder.ts:90:7

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[14/16]‚éØ

 FAIL  tests/unit/client/base-instructions.test.ts > BaseInstructions > Edge Cases and Error Handling > should handle very large instruction data
AssertionError: expected "warn" to be called with arguments: [ StringContaining "Transaction size" ][90m

Number of calls: [1m0[22m
[39m
 ‚ùØ tests/unit/client/base-instructions.test.ts:851:30
    849|       await baseInstructions.testSendTransaction([largeInstruction], [‚Ä¶
    850|       
    851|       expect(consoleWarnSpy).toHaveBeenCalledWith(expect.stringContain‚Ä¶
       |                              ^
    852|     })
    853| 

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[15/16]‚éØ

 FAIL  tests/unit/client/base-instructions.test.ts > BaseInstructions > Edge Cases and Error Handling > should handle RPC endpoint detection fallback
Error: Transaction 2 failed
 ‚ùØ tests/unit/client/base-instructions.test.ts:776:32
    774|       mockRpcClientInstance.sendTransaction
    775|         .mockResolvedValueOnce('sig1')
    776|         .mockRejectedValueOnce(new Error('Transaction 2 failed'))
       |                                ^
    777|         .mockResolvedValueOnce('sig3')
    778| 

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[16/16]‚éØ


 Test Files  1 failed (1)
      Tests  16 failed | 25 passed (41)
   Start at  16:53:11
   Duration  1.26s (transform 119ms, setup 18ms, collect 118ms, tests 1.03s, environment 0ms, prepare 33ms)

npm error Lifecycle script `test` failed with error:
npm error code 1
npm error path /Users/home/projects/GhostSpeak/packages/sdk-typescript
npm error workspace @ghostspeak/sdk@2.0.1
npm error location /Users/home/projects/GhostSpeak/packages/sdk-typescript
npm error command failed
npm error command sh -c vitest run --reporter=verbose tests/unit/client/base-instructions.test.ts
