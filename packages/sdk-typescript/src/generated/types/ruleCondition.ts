/**
 * This code was AUTOGENERATED by scripts/generate-missing-types.ts
 */
import {
  combineCodec,
  getStructDecoder,
  getStructEncoder,
  getArrayDecoder,
  getArrayEncoder,
  getTupleDecoder,
  getTupleEncoder,
  addDecoderSizePrefix,
  addEncoderSizePrefix,
  getU32Decoder,
  getU32Encoder,
  getUtf8Decoder,
  getUtf8Encoder,
  type Codec,
  type Decoder,
  type Encoder,
} from "@solana/kit";
import {
  getConditionTypeDecoder,
  getConditionTypeEncoder,
  type ConditionType,
  type ConditionTypeArgs,
} from ".";

/** Rule condition */
export type RuleCondition = {
  /** Condition type */
  conditionType: ConditionType;
  /** Subject attributes */
  subjectAttributes: Array<readonly [string, string]>;
  /** Resource attributes */
  resourceAttributes: Array<readonly [string, string]>;
  /** Action attributes */
  actionAttributes: Array<readonly [string, string]>;
  /** Environment attributes */
  environmentAttributes: Array<readonly [string, string]>;
};

export type RuleConditionArgs = {
  /** Condition type */
  conditionType: ConditionTypeArgs;
  /** Subject attributes */
  subjectAttributes: Array<readonly [string, string]>;
  /** Resource attributes */
  resourceAttributes: Array<readonly [string, string]>;
  /** Action attributes */
  actionAttributes: Array<readonly [string, string]>;
  /** Environment attributes */
  environmentAttributes: Array<readonly [string, string]>;
};

const getStringTupleEncoder = () =>
  getTupleEncoder([
    addEncoderSizePrefix(getUtf8Encoder(), getU32Encoder()),
    addEncoderSizePrefix(getUtf8Encoder(), getU32Encoder()),
  ]);

const getStringTupleDecoder = () =>
  getTupleDecoder([
    addDecoderSizePrefix(getUtf8Decoder(), getU32Decoder()),
    addDecoderSizePrefix(getUtf8Decoder(), getU32Decoder()),
  ]);

export function getRuleConditionEncoder(): Encoder<RuleConditionArgs> {
  return getStructEncoder([
    ["conditionType", getConditionTypeEncoder()],
    ["subjectAttributes", getArrayEncoder(getStringTupleEncoder())],
    ["resourceAttributes", getArrayEncoder(getStringTupleEncoder())],
    ["actionAttributes", getArrayEncoder(getStringTupleEncoder())],
    ["environmentAttributes", getArrayEncoder(getStringTupleEncoder())],
  ]);
}

export function getRuleConditionDecoder(): Decoder<RuleCondition> {
  return getStructDecoder([
    ["conditionType", getConditionTypeDecoder()],
    ["subjectAttributes", getArrayDecoder(getStringTupleDecoder())],
    ["resourceAttributes", getArrayDecoder(getStringTupleDecoder())],
    ["actionAttributes", getArrayDecoder(getStringTupleDecoder())],
    ["environmentAttributes", getArrayDecoder(getStringTupleDecoder())],
  ]);
}

export function getRuleConditionCodec(): Codec<RuleConditionArgs, RuleCondition> {
  return combineCodec(getRuleConditionEncoder(), getRuleConditionDecoder());
}
